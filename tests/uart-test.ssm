;; (define AUX_MU_IIR_REG  (+ PBASE #x00215048))
;; (define AUX_MU_LCR_REG  (+ PBASE #x0021504C))
;; (define AUX_MU_MCR_REG  (+ PBASE #x00215050))
;; (define AUX_MU_LSR_REG  (+ PBASE #x00215054))
;; (define AUX_MU_MSR_REG  (+ PBASE #x00215058))
;; (define AUX_MU_SCRATCH  (+ PBASE #x0021505C))
;; (define AUX_MU_CNTL_REG (+ PBASE #x00215060))
;; (define AUX_MU_STAT_REG (+ PBASE #x00215064))
;; (define AUX_MU_BAUD_REG (+ PBASE #x00215068))

(pseudo (ret)
  '(mov pc lr))

(pseudo (mov32 reg imm)
  `((movw ,reg ,(b& imm #xFFFF))
    (movt ,reg ,(b>> imm 16))))

(pseudo (delay reg count)
  `((mov ,reg ,count)
    (scope
      (subs ,reg ,reg 1)
      (b ?ne $enter))))

(block main ()
  (delay r5 200))

(align 510)
(resv (byte #xAA))
(resv (byte #x55))
